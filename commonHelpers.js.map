{"version":3,"file":"commonHelpers.js","sources":["../src/searchImages.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst key = '39768210-58261750239bfb23b413c7964';\n\nexport async function searchImages(inputText, page) {\n  const perPage = 40;\n  const url = `${BASE_URL}/?key=${key}&q=${inputText}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  const { data } = await axios.get(url);\n  return data;\n}\n","import { searchImages } from './searchImages';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst selectors = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  jsGuard: document.querySelector('.js-guard'),\n};\n\nlet page = 1;\n\n// const perPage = 40;\nlet inputText = '';\nlet options = {\n  root: null,\n  rootMargin: '700px',\n  threshold: 1.0,\n};\n\nconst observer = new IntersectionObserver(onLoadMore, options);\n\nselectors.searchForm.addEventListener('submit', onSearchSubmit);\n\nasync function onSearchSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  selectors.gallery.innerHTML = '';\n  inputText = event.target.elements.searchQuery.value.trim();\n  event.target.reset();\n  if (!inputText) {\n    iziToast.error({\n      message: 'Please enter your query.',\n    });\n    return;\n  }\n  try {\n    const data = await searchImages(inputText, page);\n\n    searchGallery(data);\n\n    const totalPages = Math.ceil(data.totalHits / 40);\n\n    if (page >= totalPages) {\n      observer.unobserve(selectors.jsGuard);\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction searchGallery({ hits, totalHits }) {\n  if (hits.length === 0) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n    });\n    return;\n  }\n  iziToast.success({\n    message: `Hooray! We found ${totalHits} images.`,\n  });\n\n  renderMarkup(hits);\n  observer.observe(selectors.jsGuard);\n}\nasync function onLoadMore(entries, observer) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      try {\n        page += 1;\n        const { hits, totalHits } = await searchImages(inputText, page);\n        renderMarkup(hits);\n\n        const totalPages = Math.ceil(totalHits / 40);\n        if (page >= totalPages) {\n          observer.unobserve(selectors.jsGuard);\n          iziToast.info({\n            message:\n              \"We're sorry, but you've reached the end of search results.\",\n          });\n\n          return;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  });\n}\n\nfunction renderMarkup(images) {\n  const markup = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <div class=\"gallery-item\">\n    <a class=\"link\" href=\"${largeImageURL}\">\n            <div class=\"photo-card\">\n                 <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                 <div class=\"info\">\n                     <p class=\"info-item\">\n                    <b>Likes:</b>  ${likes}\n                     </p>\n                     <p class=\"info-item\">\n                    <b>Views:</b>  ${views}\n                     </p>\n                     <p class=\"info-item\">\n                     <b>Comments:</b> ${comments}\n                     </p>\n                     <p class=\"info-item\">\n                     <b>Downloads:</b> ${downloads}\n                     </p>\n                </div>\n             </div>\n     </a>\n     </div>`\n    )\n    .join('');\n\n  selectors.gallery.insertAdjacentHTML('beforeend', markup);\n\n  let gallery = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n"],"names":["BASE_URL","key","searchImages","inputText","page","url","data","axios","selectors","options","observer","onLoadMore","onSearchSubmit","event","iziToast","searchGallery","totalPages","error","hits","totalHits","renderMarkup","entries","entry","images","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","SimpleLightbox"],"mappings":"owBAEA,MAAMA,EAAW,0BACXC,EAAM,qCAEL,eAAeC,EAAaC,EAAWC,EAAM,CAElD,MAAMC,EAAM,GAAGL,UAAiBC,OAASE,kEAA0EC,cAAiB,KAE9H,CAAE,KAAAE,CAAI,EAAK,MAAMC,EAAM,IAAIF,CAAG,EACpC,OAAOC,CACT,CCLA,MAAME,EAAY,CAChB,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,QAAS,SAAS,cAAc,WAAW,CAC7C,EAEA,IAAIJ,EAAO,EAGPD,EAAY,GACZM,EAAU,CACZ,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEA,MAAMC,EAAW,IAAI,qBAAqBC,EAAYF,CAAO,EAE7DD,EAAU,WAAW,iBAAiB,SAAUI,CAAc,EAE9D,eAAeA,EAAeC,EAAO,CAMnC,GALAA,EAAM,eAAc,EACpBT,EAAO,EACPI,EAAU,QAAQ,UAAY,GAC9BL,EAAYU,EAAM,OAAO,SAAS,YAAY,MAAM,OACpDA,EAAM,OAAO,QACT,CAACV,EAAW,CACdW,EAAS,MAAM,CACb,QAAS,0BACf,CAAK,EACD,MACD,CACD,GAAI,CACF,MAAMR,EAAO,MAAMJ,EAAaC,EAAWC,CAAI,EAE/CW,EAAcT,CAAI,EAElB,MAAMU,EAAa,KAAK,KAAKV,EAAK,UAAY,EAAE,EAE5CF,GAAQY,IACVN,EAAS,UAAUF,EAAU,OAAO,EACpCM,EAAS,KAAK,CACZ,QAAS,4DACjB,CAAO,EAEJ,OAAQG,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACH,CAEA,SAASF,EAAc,CAAE,KAAAG,EAAM,UAAAC,GAAa,CAC1C,GAAID,EAAK,SAAW,EAAG,CACrBJ,EAAS,MAAM,CACb,QACE,0EACR,CAAK,EACD,MACD,CACDA,EAAS,QAAQ,CACf,QAAS,oBAAoBK,WACjC,CAAG,EAEDC,EAAaF,CAAI,EACjBR,EAAS,QAAQF,EAAU,OAAO,CACpC,CACA,eAAeG,EAAWU,EAASX,EAAU,CAC3CW,EAAQ,QAAQ,MAAMC,GAAS,CAC7B,GAAIA,EAAM,eACR,GAAI,CACFlB,GAAQ,EACR,KAAM,CAAE,KAAAc,EAAM,UAAAC,CAAW,EAAG,MAAMjB,EAAaC,EAAWC,CAAI,EAC9DgB,EAAaF,CAAI,EAEjB,MAAMF,EAAa,KAAK,KAAKG,EAAY,EAAE,EAC3C,GAAIf,GAAQY,EAAY,CACtBN,EAAS,UAAUF,EAAU,OAAO,EACpCM,EAAS,KAAK,CACZ,QACE,4DACd,CAAW,EAED,MACD,CACF,OAAQG,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CAEP,CAAG,CACH,CAEA,SAASG,EAAaG,EAAQ,CAC5B,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,cAAAE,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,4BAEgBN;AAAA;AAAA,+CAEmBC,WAAsBC;AAAA;AAAA;AAAA,qCAGhCC;AAAA;AAAA;AAAA,qCAGAC;AAAA;AAAA;AAAA,wCAGGC;AAAA;AAAA;AAAA,yCAGCC;AAAA;AAAA;AAAA;AAAA;AAAA,YAMpC,EACA,KAAK,EAAE,EAEVvB,EAAU,QAAQ,mBAAmB,YAAagB,CAAM,EAE1C,IAAIQ,EAAe,aAAc,CAC7C,SAAU,GACV,aAAc,MACd,aAAc,GAClB,CAAG,CACH"}